<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<meta charset="UTF-8"/>
<head>
  <link rel="icon" href="./favicon.ico"/>
  <title>嗨皮聊天室 | 支持多人同时在线 | WOLFBE.COM</title>
  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" th:href="@{/bootstrap/css/bootstrap.min.css}"/>
  <link rel="stylesheet" th:href="@{/bootstrap/css/reset.css}"/>
  <link rel="stylesheet" th:href="@{/bootstrap/css/chat.css}"/>
  <!--<link rel="stylesheet" href="http://cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css">-->
  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
  <script th:src="@{html5/html5shiv.min.js}"></script>
  <script th:src="@{html5/respond.min.js}"></script>
  <![endif]-->

  <script th:src="@{sockjs.min.js}"></script>
  <script th:src="@{stomp.min.js}"></script>
  <script th:src="@{jquery.js}"></script>

</head>
<body>
<div class="modal fade" id="menuModal" tabindex="-1" role="dialog" aria-labelledby="modalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
            aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="modalLabel">欢迎来到嗨皮聊天室 | WOLFBE.COM</h4>
      </div>
      <div class="modal-body">
        <form class="form-horizontal" id="menuForm">
          <input type="hidden" name="id" id="id"/>
          <div class="form-group">
            <label for="nick" class="col-sm-2 control-label">昵称:</label>
            <div class="col-sm-10">
              <input type="text" class="form-control validate[required]" name="nick" id="nick"/>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" id="loginBtn">登录</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="tipModal" tabindex="-1" role="dialog" aria-labelledby="modalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <!--<div class="modal-header">-->
      <!--<h4 class="modal-title">提示信息</h4>-->
      <!--</div>-->
      <div class="modal-body" id="tipMsg" style="align:center;"></div>
    </div>
  </div>
</div>

<div class="container-fluid" id="chatWin" style="width:100%;">
  <div class="row top">

    <div class="col-sm-12" id="top">
      <div style="color:#fff;">
        在线人数：<span id="userCount" style="color:#fff;">11220</span> 人
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-sm-2" style="padding: 0">
      <ul class="list-group ul-top" id="onLineContent" style="overflow: auto;margin: 0">
        <li class="list-group-item">123</li>
        <li class="list-group-item">123</li>
        <li class="list-group-item">123</li>
        <li class="list-group-item">123</li>
        <li class="list-group-item">123</li>
        <li class="list-group-item">123</li>
        <li class="list-group-item">123</li>
        <li class="list-group-item">123</li>
        <li class="list-group-item">123</li>
        <li class="list-group-item">123</li>
        <li class="list-group-item">123</li>
        <li class="list-group-item">123</li>
        <li class="list-group-item">123</li>
        <li class="list-group-item">123</li>
        <li class="list-group-item">123</li>
        <li class="list-group-item">123</li>
        <li class="list-group-item">123</li>
        <li class="list-group-item">123</li>
        <li class="list-group-item">123</li>
      </ul>
    </div>
    <div class="col-sm-10" style="padding: 0">
      <div id="content" style="border: 1px solid #ddd">

      </div>
    </div>
  </div>
  <div class="row" id="opt" style="height:40px;">
    <div class="col-xs-2" style="padding:0;height:40px;line-height:40px;text-align:center;">
      <button id="faceBtn" style="height:40px;width:100%;outline:none;line-height:40px;">表情</button>
    </div>
    <div class="col-xs-8" style="padding:0;height:40px;line-heght:40px;">
      <input type="text" id="mess" style="margin:0;width:100%;height:40px;outline:none;"/>
    </div>
    <div class="col-xs-2" style="padding:0;">
      <button id="sendBtn" style="height:40px;width:100%;outline:none;line-height:40px;">send</button>
    </div>
  </div>
</div>

<script th:src="@{/bootstrap/js/jquery-1.12.3.min.js}"></script>
<script th:src="@{/bootstrap/js/bootstrap.min.js}"></script>
<script type="text/javascript" th:src="@{/bootstrap/js/jquery.qqFace.js}"></script>
<script type="text/javascript" th:src="@{/bootstrap/js/chat.js}"></script>
<script th:inline="javascript">
  /*<![CDATA[*/
  //链接endpoint名称为 "/endpointChat" 的endpoint。
  var sock = new SockJS("/endpointWisely");
  var stompClient = Stomp.over(sock);

  stompClient.connect({}, function (frame) {//链接Web Socket的服务端。
    stompClient.subscribe('/topic/response', function (respnose) {
      //订阅/topic/getResponse 目标发送的消息。这个是在控制器的@SendTo中定义的。
      showResponse(JSON.parse(respnose.body).responseMessage);
    });
  });

  function sendMessage() {
    stompClient.send("/groupChat", {}, JSON.stringify({'msg': $("#msg").val()}));
  }

  function showResponse(message) {
    var html = "";
    var nick = "";
    var uid = "";
    var time = new Date();
    html += "<div class='title'>"
    html += nick + "&nbsp;(" + uid + ") &nbsp;" + time;
    html += "</div>";
    html += "<div class='item'>" + message + "</div>";
    $("#content").append(html);
  }

  /*]]>*/
</script>
</body>
</html>